# ðŸŽ“ Trading System Risks - Educational Code

## ðŸ“– à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ (Description)

à¹‚à¸„à¹‰à¸”à¸Šà¸¸à¸”à¸™à¸µà¹‰à¸ªà¸£à¹‰à¸²à¸‡à¸‚à¸¶à¹‰à¸™à¹€à¸žà¸·à¹ˆà¸­à¸ªà¸­à¸™à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸š **System Risks** à¹ƒà¸™ Algorithmic Trading à¹‚à¸”à¸¢à¹à¸ªà¸”à¸‡ **Before & After** (à¹‚à¸„à¹‰à¸”à¸—à¸µà¹ˆà¸¡à¸µà¸›à¸±à¸à¸«à¸² vs à¹‚à¸„à¹‰à¸”à¸—à¸µà¹ˆà¹à¸à¹‰à¹„à¸‚à¹à¸¥à¹‰à¸§) à¸ªà¸³à¸«à¸£à¸±à¸šà¸›à¸±à¸à¸«à¸² 3 à¸›à¸£à¸°à¹€à¸ à¸—à¸—à¸µà¹ˆà¸ªà¸³à¸„à¸±à¸

## ðŸŽ¯ à¸›à¸±à¸à¸«à¸²à¸—à¸µà¹ˆà¸ªà¸­à¸™ (Problems Covered)

### 1. ðŸ”´ **Double Order Execution** (Race Condition / Network Timeout)
- **à¸›à¸±à¸à¸«à¸²:** à¹€à¸™à¹‡à¸•à¸«à¸¥à¸¸à¸” (timeout) à¸—à¸³à¹ƒà¸«à¹‰à¸šà¸­à¸—à¸ªà¹ˆà¸‡à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸‹à¹‰à¸³ â†’ à¸‹à¸·à¹‰à¸­à¹€à¸šà¸´à¹‰à¸¥!
- **à¸§à¸´à¸˜à¸µà¹à¸à¹‰:** à¹ƒà¸Šà¹‰ **Idempotency Key** (Client Order ID) à¹€à¸žà¸·à¹ˆà¸­à¹ƒà¸«à¹‰ Exchange à¸£à¸¹à¹‰à¸§à¹ˆà¸²à¹€à¸›à¹‡à¸™à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™

### 2. ðŸ”´ **Slippage due to Latency**
- **à¸›à¸±à¸à¸«à¸²:** à¹ƒà¸Šà¹‰ Market Order à¹à¸•à¹ˆà¸¡à¸µ Latency â†’ à¸£à¸²à¸„à¸²à¸‚à¸¢à¸±à¸šà¸•à¸­à¸™à¸ªà¹ˆà¸‡à¸„à¸³à¸ªà¸±à¹ˆà¸‡
- **à¸§à¸´à¸˜à¸µà¹à¸à¹‰:** à¹ƒà¸Šà¹‰ **Limit Order** à¸à¸³à¸«à¸™à¸”à¸£à¸²à¸„à¸²à¸ªà¸¹à¸‡à¸ªà¸¸à¸”à¸—à¸µà¹ˆà¸¢à¸­à¸¡à¸£à¸±à¸šà¹„à¸”à¹‰

### 3. ðŸ”´ **Network Instability** (High Ping / Disconnect)
- **à¸›à¸±à¸à¸«à¸²:** à¹€à¸™à¹‡à¸•à¹„à¸¡à¹ˆà¹€à¸ªà¸–à¸µà¸¢à¸£ (Ping à¸ªà¸¹à¸‡) à¹à¸•à¹ˆà¸šà¸­à¸—à¸¢à¸±à¸‡à¹€à¸—à¸£à¸”à¸•à¹ˆà¸­
- **à¸§à¸´à¸˜à¸µà¹à¸à¹‰:** à¹ƒà¸Šà¹‰ **Circuit Breaker Pattern** à¸«à¸¢à¸¸à¸”à¹€à¸—à¸£à¸”à¸—à¸±à¸™à¸—à¸µà¸–à¹‰à¸²à¹€à¸™à¹‡à¸•à¹à¸¢à¹ˆ

---

## ðŸš€ à¸§à¸´à¸˜à¸µà¹ƒà¸Šà¹‰à¸‡à¸²à¸™ (How to Use)

### à¸§à¸´à¸˜à¸µà¸—à¸µà¹ˆ 1: à¸£à¸±à¸™à¹à¸šà¸š Interactive (à¹à¸™à¸°à¸™à¸³à¸ªà¸³à¸«à¸£à¸±à¸šà¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™)

```bash
python examples/example_system_risks.py
```

à¹‚à¸›à¸£à¹à¸à¸£à¸¡à¸ˆà¸°à¸«à¸¢à¸¸à¸”à¸£à¸­à¹ƒà¸«à¹‰à¸à¸” ENTER à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡ Demo à¹à¸•à¹ˆà¸¥à¸°à¸­à¸±à¸™ à¹€à¸žà¸·à¹ˆà¸­à¹ƒà¸«à¹‰à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸­à¹ˆà¸²à¸™à¹à¸¥à¸°à¸—à¸³à¸„à¸§à¸²à¸¡à¹€à¸‚à¹‰à¸²à¹ƒà¸ˆà¸—à¸µà¸¥à¸°à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™

### à¸§à¸´à¸˜à¸µà¸—à¸µà¹ˆ 2: à¸£à¸±à¸™à¹à¸šà¸šà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ (à¸”à¸¹à¸œà¸¥à¸¥à¸±à¸žà¸˜à¹Œà¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¹ƒà¸™à¸„à¸£à¸±à¹‰à¸‡à¹€à¸”à¸µà¸¢à¸§)

à¹à¸à¹‰à¹„à¸‚à¹‚à¸„à¹‰à¸”à¸šà¸£à¸£à¸—à¸±à¸”à¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢à¸ˆà¸²à¸:
```python
run_all_demos()
```

à¹€à¸›à¹‡à¸™ à¸£à¸±à¸™à¹à¸•à¹ˆà¸¥à¸° Demo à¹à¸¢à¸à¸à¸±à¸™:
```python
# à¹à¸ªà¸”à¸‡à¹€à¸‰à¸žà¸²à¸° Demo à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£
demo_double_order_bad()
demo_double_order_fixed()

demo_slippage_bad()
demo_slippage_fixed()

demo_network_instability_bad()
demo_network_instability_fixed()
```

---

## ðŸ“š à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸£à¸¹à¸œà¸¹à¹‰à¸ªà¸­à¸™ (For Instructors)

### à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸à¸²à¸£à¸ªà¸­à¸™à¸—à¸µà¹ˆà¹à¸™à¸°à¸™à¸³:

1. **à¸­à¸˜à¸´à¸šà¸²à¸¢ Real-World Scenario** (5 à¸™à¸²à¸—à¸µ)
   - à¹€à¸¥à¹ˆà¸²à¹€à¸£à¸·à¹ˆà¸­à¸‡à¸£à¸²à¸§à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¹€à¸„à¸¢à¹€à¸à¸´à¸”à¸›à¸±à¸à¸«à¸²à¸žà¸§à¸à¸™à¸µà¹‰
   - à¹€à¸™à¹‰à¸™à¸§à¹ˆà¸²à¸¡à¸±à¸™à¸ªà¸²à¸¡à¸²à¸£à¸–à¸—à¸³à¹ƒà¸«à¹‰à¹€à¸ªà¸µà¸¢à¹€à¸‡à¸´à¸™à¹„à¸”à¹‰à¸ˆà¸£à¸´à¸‡

2. **à¸£à¸±à¸™ Bad Implementation** (5 à¸™à¸²à¸—à¸µ)
   - à¹ƒà¸«à¹‰à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸”à¸¹à¹‚à¸„à¹‰à¸”à¸—à¸µà¹ˆà¸¡à¸µà¸›à¸±à¸à¸«à¸²
   - à¸£à¸±à¸™à¹à¸¥à¸°à¹ƒà¸«à¹‰à¸­à¹ˆà¸²à¸™ Console logs
   - à¸–à¸²à¸¡à¸§à¹ˆà¸² "à¹€à¸«à¹‡à¸™à¸›à¸±à¸à¸«à¸²à¸­à¸°à¹„à¸£à¸šà¹‰à¸²à¸‡?"

3. **à¸­à¸˜à¸´à¸šà¸²à¸¢à¸ªà¸²à¹€à¸«à¸•à¸¸** (3 à¸™à¸²à¸—à¸µ)
   - à¸­à¸˜à¸´à¸šà¸²à¸¢à¸§à¹ˆà¸²à¸—à¸³à¹„à¸¡à¹‚à¸„à¹‰à¸”à¸–à¸¶à¸‡à¸—à¸³à¸‡à¸²à¸™à¸œà¸´à¸”à¸žà¸¥à¸²à¸”
   - à¹ƒà¸Šà¹‰à¸ à¸²à¸žà¸›à¸£à¸°à¸à¸­à¸šà¸«à¸£à¸·à¸­à¸§à¸²à¸”à¸šà¸™ whiteboard

4. **à¸£à¸±à¸™ Fixed Implementation** (5 à¸™à¸²à¸—à¸µ)
   - à¹à¸ªà¸”à¸‡à¹‚à¸„à¹‰à¸”à¸—à¸µà¹ˆà¹à¸à¹‰à¹„à¸‚à¹à¸¥à¹‰à¸§
   - à¹€à¸™à¹‰à¸™à¸ªà¹ˆà¸§à¸™à¸—à¸µà¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹„à¸›
   - à¹ƒà¸«à¹‰à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸ªà¸±à¸‡à¹€à¸à¸•à¸„à¸§à¸²à¸¡à¹à¸•à¸à¸•à¹ˆà¸²à¸‡

5. **à¸ªà¸£à¸¸à¸›à¹à¸¥à¸°à¸—à¸šà¸—à¸§à¸™** (2 à¸™à¸²à¸—à¸µ)
   - à¹€à¸™à¹‰à¸™ Key Takeaways à¸—à¹‰à¸²à¸¢à¸ªà¸¸à¸”à¸‚à¸­à¸‡à¹à¸•à¹ˆà¸¥à¸° Demo

---

## ðŸŽ¨ à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ Output

```
======================================================================
ðŸ”´ PROBLEM 1: DOUBLE ORDER (BAD IMPLEMENTATION)
======================================================================

>>> Sending order: BUY 1.0 BTC @ $50000
â³ Network timeout! No ACK received...
âš ï¸  Bot retries immediately (BAD PRACTICE!)
>>> [RETRY] Sending order: BUY 1.0 BTC @ $50000
âœ… Order #1 FILLED (from first attempt)
âœ… Order #2 FILLED (from retry)
ðŸ’¥ DISASTER: You now have DOUBLE the position you wanted!

ðŸ“Š RESULT:
   Intended: 1.0 BTC
   Actually got: 2.0 BTC
   âŒ OVER-EXPOSED BY: 1.0 BTC
   ðŸ’¸ Extra risk: $50,000
```

---

## ðŸ’¡ Best Practices (à¸ªà¸³à¸«à¸£à¸±à¸šà¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™)

### âœ… DO:
- à¹ƒà¸Šà¹‰ Client Order ID à¹€à¸ªà¸¡à¸­
- à¸•à¸±à¹‰à¸‡ Limit Order à¹€à¸¡à¸·à¹ˆà¸­à¸—à¸³à¸à¸²à¸£à¹€à¸—à¸£à¸”à¸ˆà¸£à¸´à¸‡
- Monitor network health à¸à¹ˆà¸­à¸™à¸ªà¹ˆà¸‡à¸„à¸³à¸ªà¸±à¹ˆà¸‡
- à¸—à¸”à¸ªà¸­à¸šà¹‚à¸„à¹‰à¸”à¹ƒà¸™ Testnet à¸à¹ˆà¸­à¸™

### âŒ DON'T:
- à¸­à¸¢à¹ˆà¸²à¹ƒà¸Šà¹‰ Market Order à¸ªà¸¸à¹ˆà¸¡à¸ªà¸µà¹ˆà¸ªà¸¸à¹ˆà¸¡à¸«à¹‰à¸²
- à¸­à¸¢à¹ˆà¸² Retry à¸—à¸±à¸™à¸—à¸µà¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¹€à¸Šà¹‡à¸„ Order Status
- à¸­à¸¢à¹ˆà¸²à¹€à¸—à¸£à¸”à¸•à¸­à¸™à¹€à¸™à¹‡à¸•à¹„à¸¡à¹ˆà¹€à¸ªà¸–à¸µà¸¢à¸£

---

## ðŸ”§ Customization

### à¹€à¸žà¸´à¹ˆà¸¡/à¸¥à¸” Complexity:

**à¸ªà¸³à¸«à¸£à¸±à¸šà¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸£à¸°à¸”à¸±à¸šà¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™:**
- à¸¥à¸š `time.sleep()` à¹€à¸žà¸·à¹ˆà¸­à¹ƒà¸«à¹‰à¸£à¸±à¸™à¹€à¸£à¹‡à¸§à¸‚à¸¶à¹‰à¸™
- à¹€à¸žà¸´à¹ˆà¸¡à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢à¹ƒà¸™ comments

**à¸ªà¸³à¸«à¸£à¸±à¸šà¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸£à¸°à¸”à¸±à¸šà¸ªà¸¹à¸‡:**
- à¹€à¸žà¸´à¹ˆà¸¡à¸à¸²à¸£à¸ˆà¸³à¸¥à¸­à¸‡ WebSocket connection
- à¹€à¸žà¸´à¹ˆà¸¡ Exception Handling
- à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸à¸±à¸š Exchange à¸ˆà¸£à¸´à¸‡à¸œà¹ˆà¸²à¸™ Testnet

---

## ðŸ“ Quiz à¸ªà¸³à¸«à¸£à¸±à¸šà¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™

à¸«à¸¥à¸±à¸‡à¸ˆà¸²à¸à¸”à¸¹ Demo à¹à¸¥à¹‰à¸§ à¹ƒà¸«à¹‰à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸•à¸­à¸šà¸„à¸³à¸–à¸²à¸¡à¹€à¸«à¸¥à¹ˆà¸²à¸™à¸µà¹‰:

1. **Double Order:**
   - à¸„à¸³à¸–à¸²à¸¡: Client Order ID à¸—à¸³à¸‡à¸²à¸™à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£? à¸—à¸³à¹„à¸¡à¸–à¸¶à¸‡à¸›à¹‰à¸­à¸‡à¸à¸±à¸™ Double Order à¹„à¸”à¹‰?
   
2. **Slippage:**
   - à¸„à¸³à¸–à¸²à¸¡: Limit Order à¸•à¹ˆà¸²à¸‡à¸ˆà¸²à¸ Market Order à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£?
   - à¸„à¸³à¸–à¸²à¸¡: à¸–à¹‰à¸²à¸•à¸±à¹‰à¸‡ Slippage tolerance 1% à¹à¸¥à¹‰à¸§à¸£à¸²à¸„à¸²à¸‚à¸¢à¸±à¸š 5% à¸ˆà¸°à¹€à¸à¸´à¸”à¸­à¸°à¹„à¸£à¸‚à¸¶à¹‰à¸™?

3. **Network:**
   - à¸„à¸³à¸–à¸²à¸¡: Circuit Breaker à¸„à¸·à¸­à¸­à¸°à¹„à¸£? à¹€à¸«à¸¡à¸²à¸°à¸à¸±à¸šà¸ªà¸–à¸²à¸™à¸à¸²à¸£à¸“à¹Œà¹„à¸«à¸™?
   - à¸„à¸³à¸–à¸²à¸¡: à¸–à¹‰à¸² Ping > 200ms à¸„à¸§à¸£à¸—à¸³à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£?

---

## ðŸŽ“ Key Takeaways

1. **Double Orders â†’ Client Order ID (Idempotency Key)**
2. **Slippage â†’ Limit Order with tolerance**
3. **Network Issues â†’ Circuit Breaker Pattern**

---

## ðŸ“š Further Reading

- [CCXT Documentation - Order Types](https://docs.ccxt.com/)
- [Binance API - Client Order ID](https://binance-docs.github.io/apidocs/spot/en/)
- [Circuit Breaker Pattern in Trading](https://martinfowler.com/bliki/CircuitBreaker.html)

---

**Created by:** Quantitative Trading Course  
**Last Updated:** 2026-01-19  
**License:** Educational Use Only
